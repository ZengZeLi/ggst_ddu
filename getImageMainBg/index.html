<!DOCTYPE html>
<html>
<style>
  img {
    width: 300px;
  }
  #block {
    width: 200px;
    height: 200px;
  }
</style>

<body>
  <img src="./0.png" id="img">
  <div id="block"></div>
</body>
<script>
  /**
   * 获取图片主体颜色
   * canvas画布中获取图片颜色
   * 根据颜色数量获取最多那个，则是主体色
   **/
  const oImg = document.getElementById('img');
  oImg.onload = function () {
    const w = this.width;
    const h = this.height;
    // 创建画布
    const canvas = document.createElement('canvas');
    canvas.width = w;
    canvas.height = h;
    // 绘制图片在画布上
    const context = canvas.getContext('2d');
    context.drawImage(this, 0, 0);
    // onload 内
    let pxArr = context.getImageData(0, 0, w, h).data;
    pxArr = Array.from(pxArr);
    console.log(pxArr)

    const colorList = {}
    let i = 0;
    while (i < pxArr.length) {
      const r = pxArr[i];
      const g = pxArr[i + 1];
      const b = pxArr[i + 2];
      const a = pxArr[i + 3];
      i = i + 4; // 最后 +4 比每次 i++ 快 10ms 左右性能
      const key = [r, g, b, a].join(',')
      key in colorList ? ++colorList[key] : (colorList[key] = 1)
    }
    console.log(colorList)

    // onload 内
    let arr = [];
    for (let key in colorList) {
      arr.push({
        rgba: `rgba(${key})`,
        num: colorList[key]
      })
    }
    arr = arr.sort((a, b) => b.num - a.num)

    console.log(arr[0].rgba)
    
    const el = document.getElementById('block')
    el.style.background = arr[0].rgba
  }
</script>

</html>